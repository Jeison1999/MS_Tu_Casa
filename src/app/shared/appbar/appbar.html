<header [ngClass]="['appbar', currentTheme]">
  <div class="appbar-glow"></div>
  
  <div class="appbar-container">
    <!-- Logo & Brand -->
    <div class="brand" (mouseenter)="logoHover = true" (mouseleave)="logoHover = false">
      <div class="logo-container">
        <div class="logo-ring" [class.hover]="logoHover"></div>
        <img [src]="logo1" alt="Morando en Sion" class="logo">
      </div>
      <div class="brand-text">
        <div class="brand-title">Morando en Sion</div>
        <div class="brand-subtitle">Iglesia Cristiana</div>
      </div>
    </div>
    
    <!-- Mobile Menu Button -->
    <input id="mobile-checkbox" type="checkbox" [checked]="mobileOpen" (change)="toggleMobile()">
    <label class="menu-toggle" for="mobile-checkbox">
        <div class="cross-line cross-vertical"></div>
        <div class="cross-line cross-horizontal"></div>
    </label>
    
    <!-- Navigation -->
    <nav class="nav">
      <a
        routerLink="/"
        class="nav-item"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }"
        (click)="closeAll()"
      >
        <span class="nav-label">Inicio</span>
        <div class="nav-indicator"></div>
      </a>
      
      <div class="nav-item dropdown" 
           (mouseleave)="startCloseDropdown()"
           (mouseenter)="cancelCloseDropdown()">
        <span class="nav-label" (click)="toggleDropdown('nosotros', $event)">Nosotros <i class="arrow">‚ùØ</i></span>
        <div class="nav-indicator"></div>
        
        <div class="dropdown-panel" 
             [class.show]="currentDropdown === 'nosotros'">
          <div class="dropdown-grid">
            <div class="dropdown-section">
              <div class="section-header">
                <span class="section-icon">‚õ™</span>
                <h3>Nuestra Iglesia</h3>
              </div>
              <a href="#" class="dropdown-link">
                <span>Qui√©nes somos</span>
                <i class="link-arrow">‚Üí</i>
              </a>
              <a href="#" class="dropdown-link">
                <span>Historia</span>
                <i class="link-arrow">‚Üí</i>
              </a>
              <a href="#" class="dropdown-link">
                <span>Misi√≥n y Visi√≥n</span>
                <i class="link-arrow">‚Üí</i>
              </a>
              <a href="#" class="dropdown-link">
                <span>Declaraci√≥n de Fe</span>
                <i class="link-arrow">‚Üí</i>
              </a>
            </div>
            
            <div class="dropdown-section">
              <div class="section-header">
                <span class="section-icon">üë•</span>
                <h3>Liderazgo</h3>
              </div>
              <a href="#" class="dropdown-link">
                <span>Pastores</span>
                <i class="link-arrow">‚Üí</i>
              </a>
              <a href="#" class="dropdown-link">
                <span>Equipo Pastoral</span>
                <i class="link-arrow">‚Üí</i>
              </a>
              <a href="#" class="dropdown-link">
                <span>Ancianos</span>
                <i class="link-arrow">‚Üí</i>
              </a>
              <a href="#" class="dropdown-link">
                <span>Di√°conos</span>
                <i class="link-arrow">‚Üí</i>
              </a>
            </div>
            
            <div class="dropdown-featured">
              <div class="featured-badge">Nuevo</div>
              <h3 class="featured-title">Bienvenidos a Casa</h3>
              <p class="featured-desc">Descubre una comunidad que te espera con los brazos abiertos.</p>
              <a href="#" class="featured-cta">
                <span>Conoce m√°s</span>
                <i>‚Üí</i>
              </a>
            </div>
          </div>
        </div>
      </div>
      
      <div class="nav-item dropdown" 
           (mouseleave)="startCloseDropdown()"
           (mouseenter)="cancelCloseDropdown()">
        <span class="nav-label" (click)="toggleDropdown('ministerios', $event)">Ministerios <i class="arrow">‚ùØ</i></span>
        <div class="nav-indicator"></div>
        
        <div class="dropdown-panel" 
             [class.show]="currentDropdown === 'ministerios'">
          <div class="dropdown-grid">
            <div class="dropdown-section">
              <div class="section-header">
                <span class="section-icon">üë∂</span>
                <h3>Por Edad</h3>
              </div>
              <a href="#" class="dropdown-link">
                <span>Kaynos Kids</span>
                <i class="link-arrow">‚Üí</i>
              </a>
              <a
                routerLink="/ministerios/kaynosGeneracion"
                class="dropdown-link"
                (click)="closeAll()"
              >
                <span>Kaynos Generacion</span>
                <i class="link-arrow">‚Üí</i>
              </a>
              <a href="#" class="dropdown-link">
                <span>Escruadron de Caballeros</span>
                <i class="link-arrow">‚Üí</i>
              </a>
              <a href="#" class="dropdown-link">
                <span> Dunamis</span>
                <i class="link-arrow">‚Üí</i>
              </a>
            </div>
            
            <div class="dropdown-section">
              <div class="section-header">
                <span class="section-icon">‚ú®</span>
                <h3>Ministerios</h3>
              </div>
              <a href="#" class="dropdown-link">
                <span>Alabanza</span>
                <i class="link-arrow">‚Üí</i>
              </a>
              <a href="#" class="dropdown-link">
                <span>Intercesi√≥n</span>
                <i class="link-arrow">‚Üí</i>
              </a>
              <a href="#" class="dropdown-link">
                <span>Evangelismo</span>
                <i class="link-arrow">‚Üí</i>
              </a>
              <a href="#" class="dropdown-link">
                <span>Grupos Peque√±os</span>
                <i class="link-arrow">‚Üí</i>
              </a>
            </div>
            
            <div class="dropdown-featured">
              <div class="featured-badge">Descubre</div>
              <h3 class="featured-title">Tu Llamado</h3>
              <p class="featured-desc">Encuentra el ministerio donde puedes servir y crecer.</p>
              <a href="#" class="featured-cta">
                <span>Explorar</span>
                <i>‚Üí</i>
              </a>
            </div>
          </div>
        </div>
      </div>
      
      <a
        routerLink="/eventos"
        class="nav-item"
        routerLinkActive="active"
        (click)="closeAll()"
      >
        <span class="nav-label">Eventos</span>
        <div class="nav-indicator"></div>
      </a>
      
      <a
        routerLink="/contacto"
        class="nav-item"
        routerLinkActive="active"
        (click)="closeAll()"
      >
        <span class="nav-label">Contacto</span>
        <div class="nav-indicator"></div>
      </a>
    </nav>
  </div>
</header>

<!-- Mobile Menu -->
<div class="mobile-menu" [class.active]="mobileOpen">
  <div class="mobile-content">
    <a
      routerLink="/"
      class="mobile-link"
      routerLinkActive="active"
      [routerLinkActiveOptions]="{ exact: true }"
      (click)="closeAll()"
    >
      Inicio
    </a>
    
    <!-- Nosotros Dropdown -->
    <div class="mobile-dropdown">
      <div class="mobile-dropdown-header" (click)="toggleMobileDropdown('nosotros')">
        <span>Nosotros</span>
        <i class="mobile-arrow" [class.open]="mobileDropdown === 'nosotros'">‚ùØ</i>
      </div>
      <div class="mobile-dropdown-content" [class.show]="mobileDropdown === 'nosotros'">
        <div class="mobile-dropdown-group">
          <div class="mobile-group-title">‚õ™ Nuestra Iglesia</div>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Qui√©nes somos</a>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Historia</a>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Misi√≥n y Visi√≥n</a>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Declaraci√≥n de Fe</a>
        </div>
        <div class="mobile-dropdown-group">
          <div class="mobile-group-title">üë• Liderazgo</div>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Pastores</a>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Equipo Pastoral</a>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Ancianos</a>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Di√°conos</a>
        </div>
      </div>
    </div>
    
    <!-- Ministerios Dropdown -->
    <div class="mobile-dropdown">
      <div class="mobile-dropdown-header" (click)="toggleMobileDropdown('ministerios')">
        <span>Ministerios</span>
        <i class="mobile-arrow" [class.open]="mobileDropdown === 'ministerios'">‚ùØ</i>
      </div>
      <div class="mobile-dropdown-content" [class.show]="mobileDropdown === 'ministerios'">
        <div class="mobile-dropdown-group">
          <div class="mobile-group-title">üë∂ Por Edad</div>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Kaynos Kids</a>
          <a routerLink="/ministerios/kaynosGeneracion" class="mobile-sublink" (click)="closeAll()">Kaynos Generaci√≥n</a>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Escuadr√≥n de Caballeros</a>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Dunamis</a>
        </div>
        <div class="mobile-dropdown-group">
          <div class="mobile-group-title">‚ú® Ministerios</div>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Alabanza</a>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Intercesi√≥n</a>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Evangelismo</a>
          <a href="#" class="mobile-sublink" (click)="closeAll()">Grupos Peque√±os</a>
        </div>
      </div>
    </div>
    
    <a
      routerLink="/eventos"
      class="mobile-link"
      routerLinkActive="active"
      (click)="closeAll()"
    >
      Eventos
    </a>
    <a
      routerLink="/contacto"
      class="mobile-link"
      routerLinkActive="active"
      (click)="closeAll()"
    >
      Contacto
    </a>
    <button class="mobile-cta">üíù Ofrendar</button>
  </div>
</div>

<div class="backdrop" [class.active]="currentDropdown !== null || mobileOpen" (click)="closeAll()"></div>
